<Window x:Class="Client.AddFriendWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        Title="Gal-Chat" 
        Height="400" 
        Width="500"
        WindowStartupLocation="CenterScreen"
        ResizeMode="CanMinimize"
        Background="#F5F5F5">

    <Grid Margin="10">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- 搜索区域 -->
        <Border Grid.Row="0" 
                Background="White" 
                CornerRadius="5" 
                Padding="10"
                Margin="0 0 0 10">
            <Grid>
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="*"/>
                    <ColumnDefinition Width="Auto"/>
                </Grid.ColumnDefinitions>

                <!-- 搜索框 -->
                <TextBox x:Name="txtSearchUser" 
                         Grid.Column="0"
                         Height="35"
                         Padding="10"
                         FontSize="14"
                         VerticalContentAlignment="Center">
                    <TextBox.Style>
                        <Style TargetType="TextBox">
                            <Setter Property="BorderThickness" Value="1"/>
                            <Setter Property="BorderBrush" Value="#E0E0E0"/>
                            <Setter Property="Background" Value="White"/>
                            <Style.Triggers>
                                <Trigger Property="IsFocused" Value="True">
                                    <Setter Property="BorderBrush" Value="#28A745"/>
                                </Trigger>
                            </Style.Triggers>
                        </Style>
                    </TextBox.Style>
                </TextBox>

                <!-- 搜索按钮 -->
                <Button Grid.Column="1" 
                        x:Name="btnSearchUser" 
                        Content="搜索" 
                        Margin="10 0 0 0"
                        Width="80"
                        Height="35"
                        Background="#28A745"
                        Foreground="White"
                        BorderThickness="0"
                        FontSize="14"
                        FontWeight="Medium" Click="btnSearchUser_Click"/>
            </Grid>
        </Border>

        <!-- 搜索结果列表 -->
        <Border Grid.Row="1" 
                Background="White" 
                CornerRadius="5">
            <Grid>
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                </Grid.RowDefinitions>

                <!-- 标题 -->
                <Border Grid.Row="0" 
                        Background="#F8F9FA" 
                        BorderThickness="0 0 0 1"
                        BorderBrush="#E0E0E0">
                    <Grid Height="40">
                        <Grid.ColumnDefinitions>
                            <ColumnDefinition Width="*"/>
                            <ColumnDefinition Width="150"/>
                            <ColumnDefinition Width="80"/>
                        </Grid.ColumnDefinitions>

                        <TextBlock Grid.Column="0" 
                                   Text="用户信息" 
                                   FontSize="14"
                                   FontWeight="Medium"
                                   Foreground="#333333"
                                   VerticalAlignment="Center"
                                   Margin="15 0 0 0"/>

                        <TextBlock Grid.Column="1" 
                                   Text="状态" 
                                   FontSize="14"
                                   FontWeight="Medium"
                                   Foreground="#333333"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Center"/>

                        <TextBlock Grid.Column="2" 
                                   Text="操作" 
                                   FontSize="14"
                                   FontWeight="Medium"
                                   Foreground="#333333"
                                   VerticalAlignment="Center"
                                   HorizontalAlignment="Center"/>
                    </Grid>
                </Border>

                <!-- 用户列表 -->
                <ScrollViewer Grid.Row="1" 
                              VerticalScrollBarVisibility="Auto">
                    <ItemsControl x:Name="listSearchResults" 
                                  Margin="0">
                        <ItemsControl.ItemTemplate>
                            <DataTemplate>
                                <Border BorderBrush="#F0F0F0" 
                                        BorderThickness="0 0 0 1">
                                    <Grid Height="60">
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="150"/>
                                            <ColumnDefinition Width="80"/>
                                        </Grid.ColumnDefinitions>

                                        <!-- 用户信息 -->
                                        <Grid Grid.Column="0" 
                                              VerticalAlignment="Center"
                                              Margin="15 0 0 0">
                                            <Grid.RowDefinitions>
                                                <RowDefinition Height="Auto"/>
                                                <RowDefinition Height="Auto"/>
                                            </Grid.RowDefinitions>

                                            <StackPanel Grid.Row="0" 
                                                        Orientation="Horizontal">
                                                <!-- 默认头像：显示首字母的圆形 -->
                                                <Grid>
                                                    <Ellipse Width="30" 
                                                             Height="30" 
                                                             Fill="#0078D7"/>
                                                    <TextBlock Text="{Binding AvatarInitials}" 
                                                               Foreground="White"
                                                               FontSize="14"
                                                               FontWeight="Bold"
                                                               HorizontalAlignment="Center"
                                                               VerticalAlignment="Center"/>
                                                </Grid>

                                                <StackPanel Margin="10 0 0 0" VerticalAlignment="Center">
                                                    <TextBlock Text="{Binding Name}" 
                                                               FontSize="14"
                                                               FontWeight="Medium"
                                                               Foreground="#333333"/>
                                                    <TextBlock Text="{Binding UserId}" 
                                                               FontSize="12"
                                                               Foreground="#999999"
                                                               Margin="0 2 0 0"/>
                                                </StackPanel>
                                            </StackPanel>

                                            <TextBlock Grid.Row="1" 
                                                       Text="{Binding Signature}" 
                                                       FontSize="12"
                                                       Foreground="#999999"
                                                       Margin="0 5 0 0"/>
                                        </Grid>

                                        <!-- 在线状态 -->
                                        <StackPanel Grid.Column="1" 
                                                    Orientation="Horizontal"
                                                    HorizontalAlignment="Center"
                                                    VerticalAlignment="Center">
                                            <Ellipse Width="8" 
                                                     Height="8" 
                                                     Fill="{Binding StatusColor}"
                                                     VerticalAlignment="Center"
                                                     Margin="0 0 8 0"/>

                                            <TextBlock Text="{Binding StatusText}" 
                                                       FontSize="14"
                                                       Foreground="#666666"
                                                       VerticalAlignment="Center"/>
                                        </StackPanel>

                                        <!-- 添加按钮 -->
                                        <Button Grid.Column="2" 
                                                Content="{Binding ButtonText}" 
                                                Tag="{Binding UserId}"
                                                Width="60"
                                                Height="30"
                                                Background="{Binding ButtonColor}"
                                                Foreground="White"
                                                BorderThickness="0"
                                                FontSize="12"
                                                FontWeight="Medium"
                                                Cursor="Hand">
                                            <Button.Style>
                                                <Style TargetType="Button">
                                                    <Setter Property="Background" Value="{Binding ButtonColor}"/>
                                                    <Style.Triggers>
                                                        <Trigger Property="IsMouseOver" Value="True">
                                                            <Setter Property="Background" Value="#28A745"/>
                                                        </Trigger>
                                                        <DataTrigger Binding="{Binding ButtonText}" Value="已发送">
                                                            <Setter Property="IsEnabled" Value="False"/>
                                                        </DataTrigger>
                                                    </Style.Triggers>
                                                </Style>
                                            </Button.Style>
                                        </Button>
                                    </Grid>
                                </Border>
                            </DataTemplate>
                        </ItemsControl.ItemTemplate>
                    </ItemsControl>
                </ScrollViewer>
            </Grid>
        </Border>

        <!-- 底部按钮 -->
        <StackPanel Grid.Row="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right"
                    Margin="0 10 0 0">
            <Button x:Name="btnCancel" 
                    Content="返回" 
                    Width="100"
                    Height="35"
                    Background="#6C757D"
                    Foreground="White"
                    BorderThickness="0"
                    FontSize="14"
                    FontWeight="Medium"
                    Cursor="Hand" Click="btnCancel_Click"/>
        </StackPanel>
    </Grid>
</Window>